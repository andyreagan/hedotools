// namespace it
// hedonometer.org/maps.html needs this in hedotools.map.js
// begin with some helper functions
// http://stackoverflow.com/a/1026087/3780153
// this works really well, but it's deadly slow (working max 5 elements)
// and it's coupled to jquery
// http://stackoverflow.com/a/5047712/3780153
// yup
// http://stackoverflow.com/questions/3883342/add-commas-to-a-number-in-jquery
// look away
// current usage example:
// (from the sankey page)
//
// hedotools.shifter.shift(allDataOld[hedotools.sankey.newindices()[0]].freq,allDatra[hedotools.sankey.newindices()[0]].freq,lens,words);
// hedotools.shifter.setfigure(d3.select("#shift01")).setHeight(400).setText("Why "+allDataOld[hedotools.sankey.newindices()[0]].name+" has become "+"happier"+":").plot();
//
// there are two options for having it compute the shift
// calling the .shift() with four arguments does the trick
// or calling .shifter() with no arguments also does 
// for the latter, need to have defined the variables beforehand
// using the _lens, _words, etc accessors
//
// if the text isn't set, will attempt to grab it using the
// allData structure (which works in the maps.html)
//
// the text setting here removes all p instances in the figure,
// and then inserts a new one before the svg, inside the figure (using d3.insert)
//
// can also use the setText method to set the text
// define the shifter module 
// my_array = Array(10000);
// for (var i=0; i<my_array.length; i++) { my_array[i] = i; }
function capitaliseFirstLetter(t){return t.charAt(0).toUpperCase()+t.slice(1)}function commaSeparateNumber(t){for(;/(\d+)(\d{3})/.test(t.toString());)t=t.toString().replace(/(\d+)(\d{3})/,"$1,$2")
return t}function splitWidth(t,e){for(var r=t.split(" "),n=[r[0]],a=1,i=0;a<r.length;)(n[i]+r[a]).width()<e?n[i]+=" "+r[a]:(i++,n.push(r[a])),a++
return n}function cloudSpriteSimple(t,e,r){if(!e.sprite){t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,r[0],r[1]),t.save()
t.font=e.fontString,t.textAlign="center",t.textBaseline="bottom",t.fillStyle="red",t.strokeStyle="red",t.textAlign="center",t.lineWidth=2*e.padding
var n=t.measureText(e.text+"m").width,a=e.size
e.x0=Math.floor(-n/2),e.x1=Math.ceil(n/2),e.y0=0,e.y1=Math.ceil(a),t.translate(r[0]/2,r[1]/2),t.rotate(e.rotate*cloudRadians),t.fillText(e.text,0,0),t.strokeText(e.text,0,0)
var i=t.getImageData(r[0]/2+e.x0,r[1]/2+e.y0-e.y1,2*e.x1,e.y1).data
e.sprite=monochrome(i),t.restore()}}function monochrome(t){for(var e=Array(t.length/4),r=0;r<e.length;r++){var n=t[4*r]
e[r]=n>25.6?1:0}return e}function collideRects(t,e){return e.x0<t.x1&&e.x1>t.x0&&e.y1>t.y0&&e.y0>t.y1}function indexer2d(t,e,r,n,a,i){for(var s=Array((n-r+1)*(i-a+1)),o=r;o<=n;o++)for(var l=a;l<=i;l++)s[(o-r)*(i-a+1)+(l-a)]=t[e*o+l]
return s}var hedotools=hedotools||{},classColor=d3.scaleQuantize().range([0,1,2,3,4,5,6]).domain([50,1])
String.prototype.width=function(t){var e=t||"12px arial",r=$("<div>"+this+"</div>").css({position:"absolute",float:"left","white-space":"nowrap",visibility:"hidden",font:e}).appendTo($("body")),n=r.width()
return r.remove(),n},Array.prototype.findIndexClosest=function(t){for(var e=0,r=Math.abs(t-this[0]),n=1;n<this.length;n++)r>Math.abs(t-this[n])&&(e=n,r=Math.abs(t-this[n]))
return e},String.prototype.safe=function(){var t=this.split("/")
return t[t.length-1]=escape(t[t.length-1]),t.join("/")}
var intStr0=["zero","one","two","three","four","five","six","seven","eight","nine","then"],intStr=intStr0.slice(1,100)
hedotools.urllib={encoder:function(){function t(t){return{current:n}}function e(){GET={},query=window.location.search.substring(1).split("&")
for(var e=0,i=query.length;e<i;e++)if(""!==query[e]){var s=query[e].split("=")
GET[decodeURIComponent(s[0])]=decodeURIComponent(s[1]||"")}baseUrl=window.location.origin+window.location.pathname
var o=""
if("string"==typeof n||n instanceof String)o+=n
else{o+="["+n[0]
for(var e=1;e<n.length;e++)o+=","+n[e]
o+="]"}GET[r]=o
var l=""
for(var c in GET)GET.hasOwnProperty(c)&&(r===c?a&&(l+=c+"="+GET[c]+"&"):l+=c+"="+GET[c]+"&")
return l=l.substring(0,l.length-1),l.length>0?newDataUrl=baseUrl+"?"+l:newDataUrl=baseUrl,window.history.replaceState("object or string","title",newDataUrl),t}var r="tmp",n=[],a=!0
return t.varname=function(e){return arguments.length?(r=e,t):r},t.destroy=function(){a=!1,e(),a=!0},t.varval=function(t){return arguments.length?(n=t,e()):n},t},decoder:function(){function t(t){return e(),{current:n,cached:a}}function e(){GET={},query=window.location.search.substring(1).split("&")
for(var e=0,i=query.length;e<i;e++)if(""!==query[e]){var s=query[e].split("=")
GET[decodeURIComponent(s[0])]=decodeURIComponent(s[1]||"")}if(r in GET)if(GET[r].length>0&&"["===GET[r][0]){if("]"===GET[r][GET[r].length-1])var o=GET[r].substring(1,GET[r].length-1).split(",")
else var o=GET[r].substring(1,GET[r].length).split(",")
n=o,a=o}else n=GET[r],a=GET[r]
else n=""
return t}var r="tmp",n=[],a=[]
return t.varname=function(t){return arguments.length?(r=t,e()):r},t.varresult=function(e){return arguments.length?(n=e,a=e,t):n},t}},hedotools.shifter=function(){function t(){st.selectAll(".sumrectR,.sumrectL").styles({opacity:"0.7"}),tt=!1,w=-1,st.selectAll("rect.shiftrect").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?zt:k(t))+","+R(e+1)+")"}),st.selectAll("text.shifttext").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?k(t)+2:k(t)-2)+","+(R(e+1)+wt)+")"}),_.varval("none"),_.destroy()}function e(e){if(st.selectAll(".resetbutton").remove(),e){var r=C.append("g").attr("transform","translate(4,"+(56+j)+") rotate(-90)").attr("class","resetbutton")
r.append("rect").attr("x",0).attr("y",0).attr("rx",3).attr("ry",3).attr("width",48).attr("height",17).attr("fill","#F0F0F0").styles({"stroke-width":"0.5",stroke:"rgb(0,0,0)"}),r.append("text").text("Reset").attr("x",6).attr("y",13).attr("font-size",Te),r.append("rect").attr("x",0).attr("y",0).attr("rx",3).attr("ry",3).attr("width",48).attr("height",18).attr("fill","white").styles({opacity:"0.0"}).on("click",function(){t()})}}function r(){console.log("adding the translate button")
var t=C.append("g").attr("class","translatebutton").attr("transform","translate(4,"+(136+j)+") rotate(-90)")
t.append("rect").attr("x",0).attr("y",0).attr("rx",3).attr("ry",3).attr("width",75).attr("height",17).attr("fill","#F0F0F0").styles({"stroke-width":"0.5",stroke:"rgb(0,0,0)"}),t.append("text").text("Translate All").attr("x",6).attr("y",13).attr("font-size","11.0px"),t.append("rect").attr("x",0).attr("y",0).attr("rx",3).attr("ry",3).attr("width",75).attr("height",18).attr("fill","white").styles({opacity:"0.0"}).on("click",function(){for(var t=0;t<B.length-1;t++)B[t]=B[B.length-1]
B[B.length-1]=(B[B.length-1]+1)%2,S.selectAll("text.shifttext").transition().duration(1e3).text(function(t,e){return B[e]?c[e]:o[e]})})}function n(){return 1}var i,s,o,l,c,u,f,h,d,x,p,m,g,v,y,A,w,b,F,z,C,M,k,R,Q,L,T,D,I,N,E,S,H,P,B,X,W,q,j,G,O,V,U,Y,J,K,Z,_=hedotools.urllib.encoder().varname("wordtypes"),$=hedotools.urllib.decoder().varname("wordtypes").varresult("none"),tt=!1,w=-1,et=hedotools.urllib.encoder().varname("viz"),rt=hedotools.urllib.decoder().varname("viz").varresult("wordshift"),nt=!1,at=function(t){var e=this
return arguments.length?(nt=t,e):nt},it=4,st=d3.select("body"),ot=!1,lt=function(){return st},ct=function(t){var e=this
return console.log("setting figure for wordshift"),st=t,st=st.append("div").attrs({class:"outwrapper"}).styles({position:"relative"}),ot||Ct(),e},ut=!1,ft=function(t){var e=this
return arguments.length?(ut=t,vt.bottom=vt.bottom+10,e):ut},ht=function(t,e,r){for(var n,a=r||Yt[Yt.length-1]+"px  "+Fe,i=[],s=0;s<t.length;s++){if(t[s].width(a)<e)n=[t[s]]
else for(var o=t[s].split(" "),l=!1,c=0;!l;){c+=1
var u=o.slice(0,o.length-c).join(" ")
u.width(a)<e&&(n=[u,o.slice(o.length-c,o.length).join(" ")],l=!0)}i=i.concat(n)}return i},dt=550,xt=650,pt={top:0,right:0,bottom:0,left:0},mt=dt-pt.left-pt.right,gt=xt-pt.top-pt.bottom,vt={top:0,right:3,bottom:25,left:23},yt=mt-vt.left-vt.right,At=gt-vt.top-vt.bottom,wt=(vt.left,11),bt=37,Ft=64,zt=yt/2,Ct=function(){dt=d3.min([parseInt(st.style("width")),dt]),mt=dt-pt.left-pt.right,yt=mt-vt.left-vt.right,zt=yt/2},Mt=function(t){if(!arguments.length)return dt
ot=!0,dt=t,mt=dt-pt.left-pt.right,yt=mt-vt.left-vt.right,zt=yt/2},kt=function(t){var e=this
return arguments.length?(xt=t,gt=xt-pt.top-pt.bottom,At=gt-vt.top-vt.bottom,e):xt},Rt=function(t){var e=this
return arguments.length?(i=t,e):i},Qt=function(t){var e=this
return arguments.length?(s=t,e):s},Lt=function(t){var e=this
return arguments.length?(o=t,e):o},Tt=function(t){var e=this
return arguments.length?(l=t,e):l},Dt="Per word average happiness shift",It=function(t){var e=this
return arguments.length?(Dt=t,e):Dt},Nt="Word Rank",Et=function(t){var e=this
return arguments.length?(Nt=t,e):Nt},St=function(t){var e=this
return arguments.length?(f=t,e):f},Ht=function(t){var e=this
return arguments.length?(h=t,e):h},Pt=!0,Bt=function(t){var e=this
return arguments.length?(Pt=t,e):Pt},Xt=function(t){for(var e=-1,r=0;r<g.length;r++)if(t===g[r]){e=r
break}return e},Wt=function(){var t=this
return Pt=!Pt,e(Pt),Pt?(st.select("g.help").style("visibility","visible"),st.selectAll("text.credit").style("visibility","visible")):(st.select("g.help").style("visibility","hidden"),st.selectAll("text.credit").style("visibility","hidden")),t},qt=function(t,e,r,n,a,c){var d=this
return i=t,s=e,o=r,l=r,u=n,f=a,h=c,it=0,d},jt=!0,Gt=function(t){var e=this
return arguments.length?(jt=t,e):jt},Ot=1,Vt=function(t){var e=this
return arguments.length?(Ot=t,e):Ot},Ut=["#202020","#D8D8D8","#D8D8D8","#D8D8D8","#D8D8D8"],Yt=[16,12,12,12,12],Jt=function(t){var e=this
return arguments.length?(Ut=t,e):Ut},Kt=function(t){var e=this
return arguments.length?(Yt=t,e):Yt},Zt=[""],_t=function(t){var e=this
return arguments.length?(Zt=t,e):t},$t=200,te=[4,6],ee=!1,re=function(t){var e=this
return arguments.length?(te=t,e):te},ne=function(t){var e=this
return arguments.length?(d=t,$t=d3.min([d.length,$t]),it--,e):d},ae=function(t){var e=this
return arguments.length?(x=t,it--,e):x},ie=function(t){var e=this
return arguments.length?(p=t,it--,e):p},se=function(t){var e=this
return arguments.length?(m=t,e):m},oe=function(t){var e=this
return arguments.length?(g=t,it--,e):g},le=function(t){var e=this
return arguments.length?(v=t,ee=!0,e):v},ce=["nigga","niggas","niggaz","nigger"],ue=function(t){var e=this
return arguments.length?(ce=["nigga","niggas","niggaz","nigger"],ce=ce.concat(t),e):ce},fe=function(){for(var t=this,e=0;e<p.length;e++){for(var r=!0,n=0;n<ce.length;n++)ce[n]==g[e]&&(r=!1)
p[e]>te[0]&&p[e]<te[1]&&(r=!1),r||(d[e]=0,x[e]=0)}return t},he=function(t){for(var e=0;e<p.length;e++){for(var r=!0,n=0;n<ce.length;n++)ce[n]==g[e]&&(r=!1)
p[e]>te[0]&&p[e]<te[1]&&(r=!1),r||(t[e]=0)}return t},de=function(){o=o.map(function(t,e){return 0==s[e]?(e+1+". ").concat(t.concat("-↓")):1==s[e]?(e+1+". ").concat(t.concat("+↓")):2==s[e]?(e+1+". ").concat(t.concat("-↑")):(e+1+". ").concat(t.concat("+↑"))}),ee&&(c=c.map(function(t,e){return 0==s[e]?(e+1+". ").concat(t.concat("-↓")):1==s[e]?(e+1+". ").concat(t.concat("+↓")):2==s[e]?(e+1+". ").concat(t.concat("-↑")):(e+1+". ").concat(t.concat("+↑"))}))},xe=function(t,e,r,n){var a=this
return d=t,x=e,p=r,g=n,it=0,Ae(),a},pe=!1,me=function(t){var e=this
return arguments.length?(pe=t,e):pe},ge=function(){for(var t=this,e=0,r=d3.min([d.length,g.length,p.length]),n=0;n<r;n++)e+=parseFloat(d[n])
f=0
for(var n=0;n<r;n++)f+=d[n]*parseFloat(p[n])
f/=e,h=0,A=Array(r),w=Array(r)
for(var a=0,n=0;n<r;n++)a=d[n]/e,A[n]=(parseFloat(p[n])-f)*a,w[n]=a>0?2:0,parseFloat(p[n])>f&&(w[n]+=1)
for(var l=Array(r),n=0;n<r;n++)l[n]=n
l.sort(function(t,e){return Math.abs(A[t])<Math.abs(A[e])?1:Math.abs(A[t])>Math.abs(A[e])?-1:0}),i=Array($t),s=Array($t),o=Array($t)
for(var n=0;n<$t;n++)i[n]=A[l[n]],s[n]=w[l[n]],o[n]=g[l[n]]
if(pe){sortedMagFull=Array(r),y=Array(r)
for(var n=0;n<r;n++)sortedMagFull[n]=A[l[n]],y[n]=w[l[n]]}u=[0,0,0,0]
for(var n=0;n<r;n++)u[w[n]]+=A[n]
if(ee){c=Array($t)
for(var n=0;n<$t;n++)c[n]=v[l[n]]}return t},ve=function(t){var e=this
return arguments.length?(A=t,e):A},ye=function(t){var e=this
return arguments.length?(w=t,e):w},Ae=function(){for(var t=this,e=0,r=0,n=d3.min([d.length,x.length,g.length,p.length]),a=0;a<n;a++)e+=parseFloat(d[a]),r+=parseFloat(x[a])
f=0
for(var a=0;a<n;a++)f+=d[a]*parseFloat(p[a])
f/=e,h=0
for(var a=0;a<n;a++)h+=x[a]*parseFloat(p[a])
h/=r,A=Array(n),w=Array(n)
for(var m=0,a=0;a<n;a++)m=x[a]/r-d[a]/e,A[a]=(parseFloat(p[a])-f)*m,w[a]=m>0?2:0,parseFloat(p[a])>f&&(w[a]+=1)
for(var b=Array(n),a=0;a<n;a++)b[a]=a
b.sort(function(t,e){return Math.abs(A[t])<Math.abs(A[e])?1:Math.abs(A[t])>Math.abs(A[e])?-1:0}),i=Array($t),s=Array($t),o=Array($t)
for(var a=0;a<$t;a++){i[a]=A[b[a]],s[a]=w[b[a]]
var F=g[b[a]]
if(F.length>22){var z=F.slice(0,20)
" "===z[z.length-1]?o[a]=z.slice(0,z.length-1)+"…":o[a]=z+"…"}else o[a]=F}if(pe){sortedMagFull=Array(n),y=Array(n)
for(var a=0;a<n;a++)sortedMagFull[a]=A[b[a]],y[a]=w[b[a]]}u=[0,0,0,0]
for(var a=0;a<n;a++)u[w[a]]+=A[a]
if(ee){c=Array($t)
for(var a=0;a<$t;a++)c[a]=v[b[a]]}return l=o,sortedWordsRawEn=c,de(),t},we=function(){for(var t=this,e=0,r=0,n=d3.min([d.length,x.length,g.length,p.length]),a=0;a<n;a++)e+=parseFloat(d[a]),r+=parseFloat(x[a])
f=0
for(var a=0;a<n;a++)f+=d[a]*parseFloat(p[a])
f/=e,h=0
for(var a=0;a<n;a++)h+=x[a]*parseFloat(m[a])
h/=r,A=Array(n),w=Array(n)
for(var a=0;a<n;a++)A[a]=parseFloat(m[a])*x[a]/r-parseFloat(p[a])*d[a]/e,x[a]/r>d[a]/e?w[a]=2:w[a]=0,d[a]>0&&0==x[a]?parseFloat(p[a])>f&&(w[a]+=1):0==d[a]&&x[a]>0?parseFloat(m[a])>h&&(w[a]+=1):parseFloat(m[a])>parseFloat(p[a])&&(w[a]+=1)
for(var l=Array(n),a=0;a<n;a++)l[a]=a
l.sort(function(t,e){return Math.abs(A[t])<Math.abs(A[e])?1:Math.abs(A[t])>Math.abs(A[e])?-1:0}),i=Array($t),s=Array($t),o=Array($t)
for(var a=0;a<$t;a++){i[a]=A[l[a]],s[a]=w[l[a]]
var c=g[l[a]]
if(c.length>22){var v=c.slice(0,20)
" "===v[v.length-1]?o[a]=v.slice(0,v.length-1)+"…":o[a]=v+"…"}else o[a]=c}if(pe){sortedMagFull=Array(n),y=Array(n)
for(var a=0;a<n;a++)sortedMagFull[a]=A[l[a]],y[a]=w[l[a]]}u=[0,0,0,0]
for(var a=0;a<n;a++)u[w[a]]+=A[a]
return t},be=function(){var t=this,e=1
for(z=-1;e>Math.pow(10,-6);)z++,e=Math.abs(sortedMagFull[z])
b=Array(100),F=Array(100)
for(var r=Math.floor(z/100),n=0;n<100;n++){b[n]=Array(5),F[n]=Array(5)
for(var a=0;a<5;a++)b[n][a]=0,F[n][a]=0
b[n][4]=d3.sum(sortedMagFull.slice(n*r,(n+1)*r))
for(var a=n*r;a<(n+1)*r;a++)b[n][y[a]]+=sortedMagFull[a]}for(var a=0;a<5;a++)F[0][a]=b[0][a]
for(var n=1;n<100;n++)for(var a=0;a<5;a++)F[n][a]=F[n-1][a]+b[n][a]
return t},Fe="Latex default, serif",ze=function(t){var e=this
return arguments.length?(Fe=t,e):Fe},Ce=12,Me=12,ke=16,Re=12,Qe=8,Le=8,Te=12,De=function(t){var e=this
return arguments.length?(Ce=t[0],Me=t[1],ke=t[2],Re=t[3],Qe=t[4],Le=t[5],Te=t[6],e):[Ce,Me,ke,Re,Qe,Le,Te]},Ie=["negdown","posdown","negup","posup"],Ne=!1,Ee=0,Se=function(){Ne=!0
var t=d3.min([j-10,80])
Ee=t+40,C.append("image").attrs({x:mt-t-10,y:"0",width:t,height:t,"xlink:href":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACgCAIAAAAErfB6AAABFWlDQ1BpY20AAHheY2Bg4slJzi1mEmBgyM0rKQpyd1KIiIxSYL/DwMggycDMoMlgmZhcXOAYEODDgBN8uwZUDQSXdUFmocsSAFwpqcXJQPoPEMclFxSVMDAwxgDZ3OUlBSB2BpAtkpQNZteA2EVABwLZE0DsdAh7CVgNhL0DrCYkyBnIPgNkO6QjsZOQ2FB7QYA52QjKoiIoSa0AupmBwc2JgQEUphBRRFghxJjFgNgYGBdLEGL5ixgYLL4CxScgxJJmMjBsb2VgkLiFEFNZwMDA38LAsO18cmlRGUSMQQqITzOeZE5mncSRzf1NwF40UNpE8aPmBCMJ60lurIHlsW+zC6pYOzfOqlmTub/28uGXBv//AwDeQVN9kuwu9QAAIABJREFUeF7tfXd4VNed9vRepWka9d4rSEINkGi2McYmrskmTtnsOpvn2+zn7O63yZPv2WTzx26SzW6ezZfkcYptbGywTUwzCAwCUUyX6KCGeh2NNCozmj7zveceMRYaQWSQhCT0xhmubjn33POe3+/3/s4991623+9nLWHxghO8agmLCUsEL3IsEbzIsUTwIscSwYscSwQvciwRvMixRPAixxLBixxLBC9yLBG8yLFE8CLHEsGLHEsEL3IsEbzIwQte9dgg+EY4O2jNgsfjQfAUcxr8fpYvaAObzebevWbB4/EgeArLZE/JevCqhY7H2UWD9kXokyfhsSDY6/Ox2Byfz8vhwAP7mWlobPxwOBzKsM/ng3fGSu6iY/yxINjt81ltowIBXyAQcNhIHIgr9rH8Xq8XNoz/Ec79PixwQPHi4vixIHjb++/VXq5NTk5Zu3ZtQlwC+PWBTjbX4XSePnPaYrEYjca8vDyRQBB87ELHY0Hw0aNVbq/X7b5eV1f3kx//RCFXEBft83d2dr677T1NaOiQZaitrWPTxqdCFLLgwxc0FvNAB53ybbPZdKqQsBCNUiQZNQ+6bWN8ll/E4QrZHL6f7R61dTS1JMfGdbe02izDi090LX6CJRLJV77ylX6Tqa+31xgWJhGLEYYRcbFVp9VmZ2VjsbWltb2tnc/nB5Wx4LGYCYZIhjzGQk5Ozj/90z9FRUU988wzSqUSK8EuxJRCId+wYQPEl16v//KXX9FqQ4PKWPBYtI+uBF+Xx+PhciGSiRvGLwwX//q83pu36gx6gzpEhQ7BWXR50mP8bNKU173ogvDS3aRFjiWCFzlmPg+GhEEs83q9+KVrEAWY8SMWoh4iH5tD4h+Hw2bWzTDIiJTPZ7Va//SnP924cSMxMXF4ZMQQFdPR2WG12mJiYgwGg1Qq0Wo0CqlMJBQ6nS6vx2O12aqqqpwOR/GKgry83IiICARpGq0XOmaeYPBK4zrh9Y6OpcO/aDD8A7Ej4PFA9my0Hz2pXC5ft26d3W7HuXhcrpDHU8sVMrGE7fUerzrqcrn1Bn1TYyM0F/ZHHqVWq9EnHA77rRvX+vs3feMb3+DxFskQ0MyLrECBLgZSqZSYgh96lcXhstxut6l/YHR4JD4hViCc+bwTZ6egJkgNms3mer0+LpvjhWgmQ1pum23M7nKOOexY4HLwP7InekOYNlSn0wkEgkVjwTNPMFoQTTM0NLRz5866urpvfetbqampLD8Z4oc/rDpaXXPxYmtr6w9+8H+SkhOCD39I3LkvRJgOcIzuRdYQp4F+5kNogJV7sB57ou8xzsRPbjixuajoHVpnnOBAU9O60Y4ILxLYAZWn9cdKuvDwdZgtR1RTU/PrX/9aKBSGhIQkJSXxefDb7PaOrrNnzoxaR202W3Nzy2wQHAj8gabBgsdDGgtBH1Sz8A9pXGYH5q4/1AChmPRAuPe7jp0lMFXyjI2NgUg0UWAEDaSO2cbG7GMIMeTGF9LyCfQ/GGaFYDpUBOeMSIa6YtnrJapKJpUg1A0PDcNJCkXC4ANnCzyOFx6YqD82DNXPWDXDN5m5Q/5gkz8ZkQAQrx7oKDMIyis4QyO8/fbbp06d0uv1v/jFLwI7dHR0/O53v6uvr1+/fv23v/1tqmAesiazQjDqVFhY+KMf/QgEZ2dnkx6KGOxjabWa8vLVf/zjn5RKZWxMLPWRcwCr3T48ila1upzOAcsgfDKUM5QXKqbRan0er1gklMnkQqEA/lksFsHavfCQd1p2BqmmbrmtrW3r1q0ikainp6ezszM+Pp5ura2tbW9vj46OBvdf/vKXVSrVfCSYehVQuHHjRhps8CflEnxv3PgUric0NNRg0E6fXR+Jk5O1AtHlzCbwQZqNRFq22+3zeLwet3toeNhisQwNDZvNA6b+voaGRrFEAkYtg4N8AVQ8l8/xDlksiHcioRh+0u9liSSSAduIVCbj8VFTvkQsLsjPj42NlYn4QsguLgerocfgnVBzDpGNjOdnMKlu9wEOiYqKSkhI6O/vF4vFt27diouLo5saGhqoZ0ZQg/+jCQiMnpb/YCF5FocqAyUTvcDiwvFRjQPRipWkjaY98At6ybXeDca5klOM2WwwOCQ53d3dFy7Umkz9IyMjOCnyH8QCMmGD5UdqhCDsdrmwv8vthim7naNcLkcuVbjdHoFA6LC7iJvx+yAasA9R+yYTGtTn8/IEXL1ehxwaTCCNDjOEKRQKcI1e8EUJphaMo8DlP//zP8OCf/7zn69atYpuHRgYeOONNy5duvS9732vpKSE7ozCA7zOL4IBGnKodVmtNqhokQiuEQZEGoXLeyiCkfM4HI6rV68iaGEBWe/o6CgsWICIwGYPDg7CB+LUoBk7w5rx63Q6sSdODdMZMHW6nI7QUB2sXCqVOZ0emVTmHnOAKyQCoBDtAovHJfBFPI/HTWKnzep2uQVCIZiWKeS5ebnp6elwpNMkmFokSEKt0IFOnz69Z8+eH/zgB0jM6A5Yia4JB56RkYFTU2omGu68IJj2OyygNmgp5EuVlZVHq463tLRiGY2OtsMFvPDi8/n5edQC7lNvpigoI0IwdqIluz0emCmMoLunp7bmIoyKxFeXC54WoRTNNGA22x0OqUTqcDrg63BShDooGtRHJBYb9Hrkw0cP7kVpf/XVV8USmUgqaWnt4PEFLoej39SPrgPbQm8AqZ0dHQqROESlhtvnCQRcZhgH3dQ0ZA7VhOJaVq5cCX8Lrzvele9QGPgNXAslOHBd+BP1oTk3XUkzTGwKpEnopvv27SsrK0OXmsj09DHzMRiVQBOjimijDz/8cPv27TCaVSsrvvWtb4aHh8NWmpqazp479/d//73s7IxNm55GA6GZpswHaHsxrpi4WYfDBbd5/vyFjs5OOFuP15uSkhISokXuOjpqg/lCsXd2duGQcGM4WhxOlQyL+llGYxhohqEgrNIAfKmmdue7bykU8ujIqGWFhR64Zs7pvLw8iVyGYvHf6MjIjbo6lVKBkG5u7bKYB9o7OtFvbGM2IRIAiSxaKUW+d/v2beT6MOLc3FxcSHJyMvw2jZqUjIkqCQvoNMR1ITYwv9h5Yieg3Z1yj0KQau7atQtdMzMz8wGopZh5gtENUfVDhw698847zc3NL7/88pNPPhkVGQOdArpwaTDcLVuexaY9e3f/9Kc/LS4u/tnPfgafOakcxhFQ78K22ey36hrQlMPDI13dXWqVmguRxOFdu3bD1NdHRqO4nLS0tIiIiPSMVJxdqVRADMOakZL19PampqaQkW+0HTUjpmCJSOx2OFEmCIZuGhwessHcZVKIHCF8eEjINacrQh+m02i4Wbl+H67LPToyeuXqje7uLshdtptEH61Wi1/0nuPHjx8+fBgpQ3l5Ofy2Wq2m5jjxinBqSj+WAz1gknun1La0tHz66afw4TCJ1157DcXSVp245zQx8wSjftD6H3/8MS77rbfegvvCNUCU+rx+LjNKhCRZKBKkpaXGxsVs2LC+tvbSlDGMkMBmDw8P19XVX7l6CwaE1lcpVVKJ2AxlbDa7vZ4wvWFFYWFubo7BoINhNTY1J8THi4QCHMhYBulPXV1d8fFxsF3a2Ez6y4b5qBQK4sDFEtLWLBa0FcxLCL/IxAJ0A6mfo+RBXrNdUDo8NqSDXKUSSMTPPv/cmvXr6m9evXDhPEI7zBAxQqVSw1HVN9SfOXM2MzPjqaeegkqC+50Y/8AoGuedrVtv3Lz55S9/JSUlGU00YTsLARhNR6kNCwt79tlnob/QhwJm/QAczxjBgdtHY2Nj3//+9wsKCr773e+iIwd2CEgqSjOAcJiTtyw7Nw/X7vISPvA/koCy2Wjrvr6+U5+d7jeZELkdDo9cLvV47R2d/XDC8XEpK1c+l5eTYQwz0IjlhTgHdT7X6NCALMyIRIkLEjmcUJVCLOANDY+SOdFcMpUSxupl81wez+jY2JBlAL2ERjuFXN58uznaEIajULcenN4yyBJwvRwW0WxMlW12m3XIgi5s1Gt02tLMnIyLNbW3m1oHh4bHxlw6rTYuISUyJg453R/e2rpr34G//du/jYmORI6F3krmW4MhDnddxdrLF2p/9V+/3vzsc2lpyW6Pt+5WfU93N7R9Te1ZmUyKK/rmN78JTwCvdn+BMh3MGMG0HuihSOERGl9//XVIm6C9JoNqEtgqGWNixoQR2CDHzl+40NvTA9+L8Ay5ZB9D9O01hmuzszNLy8oM+vDUlFSxgIga2Cg6N0OKH+EVmQbEFO+O3gH3EeHhHV3dRgNCNSGSRx5uYJ8+c04iliBVtjvsHDhvNksmlfaaTHDfpPv5WQMWS1JKslgq8fpZyOaYQU6WuX9QKpGIRSJGLvlV6pDVqysiIpqRI9y4caujowvJd0xMFPEdHA7C8/vvv6/Vap54ckNsTDS5QQrPweFERkX96te/PnSo6pMDlUePHkVXBpFisQSZ2HPPbUlKSkD9Yb7UWB/Maidi5gmGU/2Hf/gHmmDARwXtOAVwKPpvT3dvW3v7uXPnUBQUE70wmC+YgJIqK30hOyddLBZ6PL7r12/19PTFRYeDXapiIOtwRvQGNCtCYEC5YMFoNDadq0XvAXOM5iKDJmhWxGmPxwkPwXQzNg+Hy+XEiTDNiquAYiKFUBnP3NyEpuUL+KgYVnG4fLgNONXBgYEVK1YkJMb39vSdPHWyvaODDMrKZAif6G1mc/+A2bR69arluXmoHhkTRRfzs9ZtWFu6shhXMWYb0+m12IS2Eor41FzhDmkHnTJ4fSFwf/zjHwevfWCglXG1ULNoBeBe7oUSQEensAss9ebNusNHjty4ccNmtcKLOl3O7q7u0NDQFSsK4Q9WFBZlZWcwCS4MgQs53dvTHxFuQFH0FDgXWEFIg+ZE0CLBjxkiwC+fL+jq7TfodXzG1gE/myuVyW9eqnG5HHqDsXTlSh+Y53Bgf+FhBhRIB0Z0Wg0Zk2EGrUgm7/d1tHdERISr1UqckYxp+1mffXYmMTGBjnugxyQnJYEbi2WosaFRIpVAt6Ny/b297W1tiNZK7IH0GpfNYaNrisQirTbUYNBDzIvEEHbEkxD9xwQdVIPWf365aGA6npk0ItNFYQTNcMjnzre1tyEFQr4xZrcjzUVDfPvbf5OengJTaGlpa2xo1upCIY1xIKDT6QfNI1arTTHhQQQ0B/LgxMREOkRA+z79RUeBqUk0alSR2J+fFREeBp/hdLr6TCaH08kTiSGq6RMP2AdHxURH83g4lpg0TB8uGcFSFaLW67U+L3lIDdtGbHa0v1yuIMkxk9mOjI7ExcdnZ+dA20NgwoJxnQqZbMDUX3frFvpWfkFBUnIyqsS7I0QCw3lccrrPm3F863yz4OmA2BDTMUdGbSdOfbZn926IT3hI6gPh2CGwv/7q1xC36B0npM5IkwYtA5DK5OrZbD5PAOfmdTsgfSnlgcLRIejdt4nrvSDE75dLxeT+IHEa3CvXbp47cUytUnZ2dT+zeTNPyCdCXygQ8oSgjukH4+xime1DQ5OeEaJWCwTwIsxV+P3Nze1QkUajnimWJD9VVceMYcawMD26VFp6OvRmW1sbUt2kpMTu7m6k13aX0+31ooPCTz+cZU4Xcz0xhVFSbJvV1tjYWH3i5I2bt5QKJXrz6MhIT093aWnpSy+91NR0G6lRUVEhuYXHYgn4vPi46CNVVWmpiSJEKeaOLjKftuYG6tAmEozlYLemCVGQGwPjexCbQLiVSKUulxOSDfqaPOfA9imk0omj44Ey6POI6BmEdTrTiA214QNZScnxzLn8+H9Pbw/0F2IB45tY4cawF57/Ulx09K4d2y/V1oJdp9ttdzoszHBedlra52e6g9l4v8AcEeyBPKWhl8Vqb+9EstjV2Wnp6dEp5Mg9RHyeMSr8f/3938XGxnG8LHEq/8SJz7wuD48M45HDVQppRJhu2GKRGY2kQdksXajcZdeTgWLGIQcYndKnkbuA466QeEbskZOe9Nff+Q4y1+KSEjr9irFsapyT4fUw445Q4UjluRwIIDInhOVLjI+QiUkNQbrL7e3u6FqRv0wsRPhHgCYFjg4Nnj1zqr7pJvpTVGS0OlTb12fua+++XnNlbGhkef7ywO2K4JPOFObOgnHBECC9vX2HDh1GOu/1esQiocvp6O7uksikqRlpMVExaCqiVhQKg05nGbTA15EDmTvwKSnJHR0dYQZDIG1ALkF5nWSvwQjejEOWLV9OF+6suWuHiSAztoggJF0UHggCiARmDqKKfHwHNht5dkZ6BjMBjewIzpAIfPLJJ5WVB9A7tXq9WCIx9/eHhmiGh0Y627vMA2apTArBP6vsAnMUg4me8vluNzV//PEuBFoEu46OdoTA2NgYk7kfwurUyZPZ2dmRERGQLzBIkUg4MDAYEqImc2tJ0/uZZFFMb5cGin3IcQAcPh2lSvUgmQmCve7kWsSPfN45yALNCWlpSNv27t27Z88eOJjo6Ois7Oy//vZrEqkCitLl8bhcHpfHAQkGD4Rs6iEz3ftjdi040HYet7f6+Inq6uOwxeXLlw0Pj4DaNeVlTqejrbOjublZq9Hu3b07Kz0DehbuUKtDisKDxoZBkxKYVy/Q7CtQOOUGCw/GceDwKUFrzgxokOVLly7t3r27rq6OPscG2ugsA3pqmouTfsAUCEd1+PDhjz76CEYcGRm5fsMTeXl5SpV6zdo1MrnyzTffVqtEVqt1ZGS4v78fBxYVFdGTzoY1z64F0wtGd25qan3zrbeMRmNycrLH40W3XbNujUqtVKnUmtAQpL9olNqLNWgOZniBGLGYpIYkIWQ8HlpyihuLZO1DWDA9dsoSsJLeFQBu3br5ox/9CJW0Wkeh8KEEmbGzz7P8QDm0Q1y5cuU3v/kN2NVoNFu2bFm/foNCqSLTgDz+8AijRCKDhNRq1bR86ABIbjrL4GGu5V6YRYLBLi7Y6XSePHVq9559+rCw2JgYuUIhEgrdHrdepyNZEJskqU6Ho6+nVywQNtTXr1m7FgkLujLoJNGOCd6z8QzE/REw7uvXr7/55h+6ujv0Bh2fz122bHlOTjaujMud2vmhp27durW2thad+OWXXyaPpwqFRHSBPS4Z21GpddDs589/Ru8VDg0N2Ww2ZHfwT7Mx234WWw5NhEa6fPnKiRMnhSJRSnIKLl6tUlVUrMzLyam5WGO3j6EHkIlaT28E91KpZMBs3r//wCRRNMsqZBLGeSVDmxyOy+U6dLCyra1Vr9PDe4DUttYWZLf3MjWsh7uCaeI3MzNz3bp1ROQzKozqalP/IBLCjRvXv/jii2gN7CoUCusb6mH0XV3kTvaMg/vD//sjL9H15MroxAl0Ny/DjcdLxCNEgdfH4jETqaYDtxfZBDnQOjZ26rMz23d8oArRGKKiBSJRUlJCTlaGWMCXS4VKmdjU26fXanGIUCBISkmGAGnrbD93/tyqVauUSgVpEzJ8PJUIni3gsj1ED5LRSbbb5z+0f9+Od7fy2RypSMz2c3lcQUPD7YLCYp0ujLnHGHQ8A0Qig8GAhF6pVDIhhFHgPl9vT/eYbUSvD5VKRDFx0WK5pLOr0zJisdpsDpejoakhKSEJKTKOCET3hwf3X//1J2P2McR8xiVy6VNipHC/v8/Uf/z4id7eXkQIiVg0zROiO6ByZvPg4SNV16/fiIiIkCvkoRotREV4eBgYxTlguBKJZNRqgzWoVCochQQDahOiw2KxwL/Bs9EcMaj42QaZGoSgjyVzv/l//vuXUrFIG6oRCkXo6BKplMvjy+XKjIx0ZqhrCqANEXSysrLuvtfr7+rqRAsbjeQdEoyXYIeHRyIwt7W2KZUqp9NF/rPb0VxQ4zOoq7mvv/6/33ln69tvvXXzxo242FikLsRyyFRFe+X+yupjx/Z/ckAmlWZmpk+3udns/oHBQ59+evbsWblcptXqeFxuYUFBRkZqbe1lKBOtJhT7gD8EHjgoGnhQuEKhgMJCzDt58mRsbGxiYuJsqMr7gkyFR6OjBdDc723bVl19DKERybeXzB7kqdTqoZGRvt7+spVlEsnUQ+5UCQb0IP2FN0ZX1uv1NJUiK5lp9wq5vKenBytGRkZxEAjGpqioqGA5+cDgbn560+9++zuf13O7qQliLjUllZlXxmpquH3w4EFUSKfRDA4MrFxVdp9uRSUJdVC9JnNl5cGGhkaVitw8CQvTFxeXREcapRIJrOHy5ctMJxUiCvCZmacBFnFJaM20tLSrV68i5V2+nAz03HWa2QcRdMw78c6ePr317bfhMGNi4zLTUltb2xB3SsrKbGN2qIoVxUVhBjIIQxEggy4EHCy9NCwD6M30ckhCRd7BRtZbhkbQb3p7+6xWG58v8Lpddrtdp9NRUT2p8EDOhl/4uaamppGRERoF6BnpID8UABbonzgXD/9oQ0PhpZUKpUJOJr8hhGKDQChob2tDtdDvhoeHmTda3BO0OCy43O6LFy52d3dDMYWFhWFLfn6+TquBHPZ5fZHhxq4u44VLl8tKSxDZZaJxXzSxt6L/vvHGG2jZuWcXgP7wuFy3bl7/7f/7lc06rDcYv/6Nb42a+65cvixVqJbl5fGFouvXb509czY3J5NQNVUmPdHx0EubZBuIg3Dwff3mjo6uhPhEkVB8oLISbIUqZQiIcGCgDX6eFh44FkXRaTPIrNBEWI92Ligo2Lx5M+Iddoayq66uRgnQa/CFSOeQp5FJ9PFxcXwuf9XKlVB9qBqxYJ8/Njr6r7/5zY629oa6+uioaAiMiVUMBk6PExw5fPhYdTX+RDeEFa5etVKLc5ACvehn4KywMB/u6fzFS+hmQWWMA3aMQ+bcPxOA4O7u3t/++n9GhywquSwzKysuKamltbW/30xmVrPZUPvwalCCWIM2pd36AWC12ZuaWjhsrk6rW7Yst2hFsUqphgQxm82g59atWzDEYKlFXXdHRwfCH/NAs+PChQtIuKnvhObftWvX/v37QXxDQwMcIZmq97P/+NmKoqKKiorS0hJ4TuJNIDHYLC6bGxsbA5s39Zu++rWvGsL0k042EUy+6zpWffzixYsaLeqsF4slSUkIo4noqziQS2a6kQAHISeRyto6upAQq+Vk5DYYqCtz13bGlOT0AfWAgNXcVK8JUYeEhH7la18XiMTnPzuFVFUdErpuwxMhGg3aDu4xOTkxMhIqaRzBRd0fF2uucLi89PRU5lY/F2ELDdhv6kGGhQWTqT80NERvMDDp8+eFg2Bwhn6wd+8+iDj6hHtKSgrjLFnkWSs+f3BwEHQAcL2wXu6Pf/ITeGOZQk5u3RB5AYdO7qz52X7QkpWTtXpteXhkRGCm3ET4/QhMJG4hj7rZ0Lhnf6WfzcvMzoH8TktLH3M4BywWeAnqp3AZ4AzFyGWSpLiYe7GLfWk/nTN2qRXiFwbx03/7t+6uTrFU6vR4X/nKV+EAr1+9+umhT6UKZXh0dNayPJlMKuDzTh49ajKb165dGxxi7g9qanX1dZah4ezsLLmcuFaETtsYmbhvszsQ49GlkF60tneEanQhoaE+8gAzashhHu8g1qfWhAyaB8hsAjY7Li6uqKgIkZQJ7WxjhLG9o6N/YECr05WuXKlWh47HOewamMeL1iW1YO6c8JAVKBTMn1PcTCOEcbjYbWhoeM/efS63p6i4VCQUpaWm5uVlD1mGT585C7eckpzEF5Bgj0qQX5xlri3zfqBmgWuH0HXYx+z2sezs7MzMTDg2wh+jPuwOe6hWg6CD5bzc3JLSkn2VB+BIkQ4xbTMtBCaehodHRMUkCIR8KmyaW1pMJpMxLGzVqlVwFUMWi9fnGxkdvVVXZzDoQ0LUjPgjJI3PcWJzXnzxpbNnz6BHop5hhvG7amhbpHOvvvr1q9eviQTCcGM48cSBoUoYO9w6AkBXZwdsX4AMRkg8Ns0c7iHbydXhNLv37L105Wp2dg48sE4bmpeTJRIKxSJRVGQ45PTYmE0pl5G5EAzmzDSnD+ozoOwgTNBkq1evBsegE6oCqXx/Xx+ua3lBQXRMDNI8AZ/vsNthhWAF+0989uT+oG4JTYa2JYPsxF2yRketIDI1JcVoNKpUKr6Aj2CP3eBpW1tboyKjdDoyt56hlvYkHMRRyKRIN9C94IeZTYQjJnsnQTDCGE6mlpIpbCxiWMC5c+eOHj16/vz527dvux1OJOOq0NDSstLXXntNH2b0kxnkU4ksxr2gCaqPVccmJETHRBvDjMkJMXBiuAwehy2XyVaVlSBmoNckJiSQgZRHIZ3uD+o2KceQr6CWKgA0C3p8fX1dZ2cnF0mMQEjmfeC62JxVq1eP2Gx79u5hZtXTSR1/GdgNZTI7k/+7ySQTtnlgMCIyAiwSMliczPT0zo5OqpsQUOvq62PjojVQ1MzDsV6fx+32kuzyDiNUjTJXQB6j9bHG72uRp4fgL6Fm/uVf/mXv3r3//u//3tzcDGkORl94/ktFK4oglY4eO7Z9x/blyHN0OqSrQRWGT/A2N7d8/PEugUgUqtVyefycnCyFVIw2Q45LehqbJLtIv0LUapKAzc6T8w8JaliBhYk1hBw9f+48WkqhVD61cSN0DXljC5sNuhOTEgoLC9VqNX16cZqgp8DZyNRKDntgwAI9lRgfx+fTWSV+oUgYGhIK20VoQ/dqbGzg8bjQUCQ6+Hww9+9//3WsLCkqpqVNKJP6WuIXnC7nf/7nL7q6u+EYOJ9++unvf/97hAdUF+56y5Yt5RVrtjz//Ouvv/7HP/4xISHxb/7m29evX58yzrhdLtg9fTJToVAghb1w4SJ5moOZrkw66p3/aKvNQ3bvBdp2RH9BFSoU0FYQMsQN3gGXy4OKhsVPPwZPAjiGvE1LTQGpjMQh8+K9Xh9OV1FRLpFKNVqNw+lEttPe3gZ1Dd/rdrtg1jdu3BgaGrrPeW83NSFfvXHzumXIwm088VY6AAAXqElEQVRpaUG7l5WV/eM//iMcN+NFx5UFJFx6enr1ieMdHe0Vq1fT2YoTce78+W3btiF4REaTh6OLi1egRWovnNNqQqVSCTokfBJ5gxKZtDQ+pjOphHkLOjRXU1Nz8sQJr9uD1CA7N4fEt3GroW8WGB8teoDrIkPebJYQ8ZyZ0UCPhwy6dvWazWpNTkyETx4dGeVzeQODZr1OH2YwwG1AJQxaBjvaO6IjI2FONLIEyhzvJSxWS2vLjZs3EdETExI5kG3Lli374Q9/iHwGqooEf+bGGPw8jklISNj01MYjhz6tOnbc6fG5vX6Xl9xwcfv89Y3NNZeuCaVyy6jN4XRB9CM+JSfF5+bldXZ1Q5ASUtk8+h/1IYGqzF8wVoHe7WGxnB43EbQut1ypDAkN4XO5zIzO8Vakg6wPfEcEQRT/8TlsMkHa5yWvb/L7mhtu8zmC2KhoLotdnF8QHx2vC9HKxfIrNVfaWzrJ45RsriFU73a49+/fD+ImnZqNPkfeP+K9eukShNTw4GCIUkkyhJycnOCnNwHqBJ599tnYuNj/+q//dnvIA2KwRwgrp8t95dq1lrY2sUSamJT4wgsvqMmD7qR89K3k5OQHdlzzAUzV/TbbGDQUnLBlaCg2NnaW4gt8AFFDPp/d7ujtNSUlxopFYrhRmPbyZblkOEil7usztbW2jY7Y0LwlxSXpaeloXchhKpADRVG12NfXC8ms1WhKS0oRvMljteXl5RPO+DnQQXBV2Ok73/k76CzkiMQjkbXswYFBiLLe3l63k7zaQqGQkzSZ2YReBU8ynecb5jfYDqejt68PbYqrQxjCqtnotdTDo2Eh6DIyUpHIksnXzDPMWm1oZka6SCxG+AedjY1N2F+ukK0uX40/IYxcLtekbgf5DckMGQRJVFRUhJK53/3ud4uLi5lZZJNdDdbgNPhNTEpau3YtehOzkuVyuU+cOnnj+o1QjQZJgkgk7Ovri4uNJRoENDOBgZ54YbjlSWDejoYQ63Q4r1+5giQ4NT2tuKSEMjEbV4TQC6pAiUrFtDB5SIkIGETLkJAQ6ACctLOzy24fQyRWqpTh4cYzZ04PDAxgq8FgoKkXvSP5wQcfIDuHXkbYRUKPOnN/9atfkWT5HgO/9JJwZehZ+APXCP/c3dNz4EAlCoKZlpQUb3zqKSjyK1evhEdEiEUiHjP4PEttMRegH71js9taW2ov1kJh5S7LS0tPH984CxdFtRIdVhpXbPSePIK0gCcRSYeGhxnNNSKTK6IiI3lcriEs7Nq1a7BjcKzVakHtzp07wa7ZbEZHyc/Pp2EXZfFiYmLuZN/TAti+fbvZarPBadNnLPkCQXn56hs3btbU1JaUFCkkU4TzhYjevl4kJ3KFHAkCNYBZ6rLU4d2r8MioyKqjR7EZNN28cSPcGAZPnpWV6XRuef/99//whz9AHQ8ODsIHpKSkuN3uwoJC2C7Jmxl8ARFI9xsZGm5pbg5RqWJx2T6fXqdFKZAJOdlZUPD0tZ8LHfQa7GN2cmlcXlRUNFrpXk7u4REo1u/33r0FYIslosjIiIaGBubFaeSFE1ACcL0FBQVqtfr06dOQ01iJIIucFuYaHR0dmDdCLHi699WZW0xQetve3drU1IReY9Rp4uISIOhRFE0PDaEL/6slTFOTXMjn8zhdEFloNYVSMUnLzBICD5+hM1G3in/5fD+H5+7uaQ0JVXq97uaWVjjzhMRYFosLkwWj1HzlcnnoVO0/3VkT9JRW6+iVy5eh9+ArHHb7q69GeD1ePu+ux78WBxB9kCY4HI6IiIi5YXci6PgJc4+Ldfr0Z9u3v69WhdrtdqlEgdALPxyfAElL9gTZ0FmTj5+ALzAtBrYOw/35z3+Ocxw8ePDkyZOf7Kt84YUXv/71VyMjw4P3X9BAvgGZikuGyJh7grlcLqQ1GK2srNy+fZtQKFAq1YWFKwyGMK/Hl5ObG7CmQOYWWJiELzbvCZcKP4C8GdkzEqSTJ85UVx87d+7sa6+99sQT6+mIOUAjFjD3TfPwoL4ROQIUaUx0TELCzL/U+i8CdYBCpk9IIKYCK1asoO9lcrmcAsHnb2JmQjLB1Lf7pk9w4HjaU0Dzq6++mpaatWPHDtTm3Xe3ob9v2LBBqwtlXntDvtz6SGbNPSQou7AetC8WJFLJI7kKdK9f/vKXjY2NMCS93lhevmb58jzGWvzMbXUfCAnsTMXUhKPvwoPUnvYXXHlRcWFiYrzZPNBv6v9o5876+oYtW57NzcuB5n/gQdpHC1pnn5c8UgVzgTR9JATDfvLy8mQyWVpaelxsYm52DtqbVm18IHX8zsJfxheuPXW/WKDCiiba8fGxEZERVVVV727bVt9Q9/LLL5O9yDunFpiLpmFleGS4vb0d1kxuhD8KggcHLRABRmM4mC4rLeYwL45B7QL51F173xcPQvBE06QP2Ym4Qug6nf7F06fPfLxrv83ufe65TUqVgs3yYTscNp+DzGwBGDQuDbx2dnbS5DI8PHwu/ZDTTfLgUav1D2++LRAKxBJJ/ooivjDAEa0JZXe6tZpBC/PTd+tueOKJPpPpt797o6urm83leMk8F/IW0AUBWDACcF1dHQhGchkbGxt8F3z2gC7lcLmOHKnqN5thOfn5+RpNcGoLar9An5sZggNmLZFINqxfs3JlidPl3PnnP1+9etXnQ0jDtoURjynBYBcpCpwzAhCNR3MDKFOwe7GmBqHhiSeeyMzMmDiH5MEwMwTTeExZlkhFxcUrkDWhuu+9t/3QocP9/Wb4PSqt57K9HgCoXk9PD3l/okSiCSXzZGfbRTM5DmkZr893/MTJ8+cvREZFrVu3NikxnkfC38M214xZ8IS/yGs3i4pWvPzSS6mp6WfOnHv33fcbGpvo6Mw8JxiVvH79+uDgIFR0mDEMOnYOKoxT4Lznz5/ft28fZHt6Wlp2VhaaFMnIvbLb6WM2VC555zKHzYqICH/h+S0lJaUWy8if/vinW7duzXN2AdQQ+pnWEworaPvMA9QODw+D2k8+2RcRHlFSUpK/fBmoDd7zwTDjOQCaBs1DHrWAYUulsjUVq1QK1dXLF3bu/POqVf1lZWXzfHgLMRi/qGRiYiL1n0G7zCQQ7Lfv2MG8Q1WXuwy6ajn5hM/MhYUZJ5jNhV8hN6zH/xZwBStL8wVc1tGjxw4drDIYwlOS0XDY7J+H31N3OBwwKQAZARAQjzMOt5c8iTw0PHzo4KGW9q5wYzjiblpy0oyfbTaMaYo6Ll+eV1xcPDI8snvXnoYGMlsseJ95ArPZ3N/fTwmm2jB4n4cHigW7e/fuu3rtGmLBpmc2JSUlzkZfmiNvyeFwly3L3fDEBoVC+dZbb7e2tgXvMx8AapH4QjxHRETgd/ZUodVq27//QH19g9FozMjI0Ot0sxQK5ohg9E25TFpRUZ6SkowkZNeu3WbzAGMesx7kvhCgdywWi1wuJx+7YzCDioH6LZRptVr37N17+coVOLvkpOSiFSsCbymeccwRwdQlS6WSwsKCl195ZXR09MCByr6+XmYTwaT9HxW6urrI+yrIlFXyrZPgHR4GCOe4UpvNduHiBWTbIqFw09NPl5QW8/hkDv0sBfs5Ipg8Z4uTsVkSiWj5sryi4qKOzo7339/e3d0dvPMjBEQWzFej0cTGxjJPeI7fWZkpjI2NHT9+HM7ZZrUhI1qWlwuayQMDwbvOEObKgslQ13gKBY4LCpYjl+/q7v7tb3/X29s7fyz48uXLqA8cDBQWqGVGG2asiVwu9+EjR2pqank8PqLV2jUVfPrlM4aGWWJizkQWSZzIM8pcMqc8JES1Zm3FqtXlPg73/Q93mi3DyBqYR56CD50LoJXRyejstcjISPhniYTMXwze8wGAjMjt89ud7qPHTx48XDVqd67b8GTF6jKxgMfnsoU8DnnYl/lvNjDXYw50BA4LEol4zZq15eUV7e0dH+/a3WvqZzZP2n1O4XK64Ja9zKdHIbKCd3gw0NB7/mLN0WPHQjXaTZs2FRWtmO0h7gDm+m42DWn0mnk8HuIxdM2FCxccTucrL72o0WqCjph1BJT8mH2MzjSCHaN6M+ec/X19/dXV1TjL2jVk8s2c3oIMXjWroFGNhjc+jyuTy8rLV1dUVJhMfTs++LC9rd1LbiDPaeJEFQDqgyQYEtrtdmMBTAft+MVAB0mA7u7et99+u6+vD+nQihUFPC6Ju8H7zxLmmmAKOgTI3JNghxuNq1evKistczqdH3z4UWtrK67fw7yPL/jA2UDgjRy3b99G58Of0eSjSQ/l2wKvLDIPmCGsICezMjPXb1gn4PMRoXDVQUfMFh4NwRT0JUL4USjkxcVFy5cvHxwc+M1vfnPixAkQPGdRCsC50L3MZjMIViqV9L1iDwPq3iHId+z4oLamNi0t7Utf2jKDcX36eJQzW0EgvBi6s9/HkkulRSsKYUcnqqs+/fSwUIhUKv/h74ZOB9SXDg0N1dfXY1EkEpNP0j1g90J3JQeiwJaW1o8//hiFP/30xvyCfKWSfNSOPef3Vx4lwVwOi3m0afyLnxIhf035Spbfd+jTwx/+eReLy8vNzSVDPCwW0omgo2cMOAXiLswXy3p9mMvpUYeEgmDmNek0PE+zldA/6Qsmec3Nrdve3Y6iYLvr15aP6zXyYO3kY2Ybj9JFBxC4bPxLp+3x+DxorqPV1fDV9ItFsweq+CCCkPs6HciDo7QaQnDwnn8JzFRhPxu2u2vXbrFYlJuX89yWTRPU+CMYdX+UFjw12OziohVIJOrr6/bs3qNSKvOXL5vVfg8u4UjhogGFXB0REf7AaQzYNZsHdu7cOTJiTUpMXreuXPQo4u5EzBeCqcXAApi3CvHz8nLR3DGxsTAFGFZWeioJ1Xdy6MkHPxzALsrs7OyECIK16Q0GxhCna200F8ICU0hP1ZEqk8mck52z6ZmnyTtC7/mJ3TnCvHDRAaAtSGuw2fBvFeWrMzMzoH8+/PCjmpoa+OqHz02nBEi12+0Iww6HQywWa7UaatPBe04JSiD2t1gsH+74qKuruyC/cNOmp5nvipDR96Aj5hTzi2CA+XwyMWWRWLRq5crNzzyDNnpn6zuXLl0K3nmmMDIyAnqY14Tx5F9wJiW14Obm5u3bt3d398bFJTzxxHqFUuHzeZl3qYx/XetRYd7FYNK4zHscYRtikTB/eZ7P66m5cOHAgUqny11YkD/j43x0iAMRAUYcExstk0uxhvmoCs157kX2eEaEow4fPnLp8mWX01VQWFBRUc689BCWzfH5Iap9j9aG5h3BkzIinoC/qqyEIxDv/PPH732wExyvLC1m7p/6ubwZ0y/IkcbGxhAFoqMjmNe2kpX3farA73W72ByOw+nZu++TC5eu8EWSijUbipZlSSUSHE54JR+/m7sx53th/qnoIKC1c7Iz1WrV2dOnDx46JBYKcnOyhCLynpEZAQ2ikHKIxElJSViexvwKYqEer6+qqqrx9m045FWryvPz88SQiIzFP2JlNQELgGBALOQnxceKBQKPy7ntvfecLldJSbFghnwfHPK1a9esVis4DgkJocNnNDkO2vdzeH2sxsbbx44dC4+KTk3PyMvJ5DOfWpwlqf/AmHcia0pw/SykGzFR4evWrlGHav709taDhw67XC5sCmQpdPmuw+6LgE7u7u5ubGwUiUTx8fF0UOI+5ZCHiJgnrNo7u/cdqOTyhQa9vqy4SCISks+/k8d2CJYs+IuBw/FzyDgROzYm+oWXXjpy5Ojho9X9pr5NT29Uq9WUFbTphDGjaYF2DpPJBKGkUChiYmLoTaT70EM33bx5649bt2G5sKBw/dpymUTkg/pnhFXQEY8YC4NgZliYMIh/U5KTuTxB5aHDN2/dunnj+rPPPltcXExv+f1FvzoRgT1BMJwB/tTpdPfvIvQUXV1db731lliuBrvlq0rEIrALSUW+YjIPPeKCcNH09XnUAZLxrISEuFe/9lfr161TqdQffvjhiRMnEJXJHl9kUIH2Bp/XZ+ozoWybzYbSgndjEAgBrL4+0/4DlQKhsKioqLxipZj5Zif5jhkz+nX3UfMCC8KCyXQ9OsaFf8R8IoLEKtnaijWaEF3lwco/79ztdHrXVJRTO8ZWhEk66XVSQRPhgzv1sRxjzrprdT6P32CIUGt147ntXUAyi3QWCxyHw7Xjo10mkzkrc/nqokIpn0dUFUqCnXDmaUsuDBc9RbMTsMk3UVmsA5WVB/YfEAoExSVFPB6XTJmYRjCmXPb09Po8PmNYuFgi4fOmTFvJS9A9PjLJZP/+A21trQaDcXn+MqlURH32/NFTU2KhEDw1+HxeTm6WWCKurj5+/PgJpDpr1paLROS9vME7BwPCqKe7BwrL7/MhlAqFgjvDU5N2Y3u9vs9OnTp8+HBkVMzmzZuio8PpO52xdYng2QIslVE37KSkRLRzZWXl2XPn+s29W7ZskcvlaHeAeux7cQCjJB+eNJu8zOuCJk0godaJX5fLc+r06e07dkRFRb/yyosx0TE06M5zaikWRh48JdC85Ivl5Asi7MSE+C1bnouJiTb3m998800I3YCovicNfr/D6XST97QqBAKBVqedOMpN71zh1+VyHzp0ZN/eT/R64/Nfeh6pFHH/zCdXPi9qHmMBExwArJTL44QZjU9v3JiQmDg2NvbRRx/RKTjM1qnFLRgaHRnp7CRfXpfL5CqlknfnXZsAtWZ4iOMnThw6eFguV73w/AtwFehRfpaXxZ6/zzdPwqIgmEyGYgn4HL1eV7GmorCw0DI0tH3H9tY2MgM3eH8KhFWP19vc0ux0OSUyCQL5xDzHx6gqxPUDBw4YwvQvvfRCeloKBBy500XC74LBQiYYPpL5j7yNhsd8y4LLlsrlRaWlpatWmswDv33j95+dPWO1231eMghBhxh9PvxCFLsRXhtuNwjkQjvLJQuVxyfFoRzmc0k+p8fv8vrOX7x05NhxqVzxlVeez0pPFpIZzSweh80jMWHBaJfFYMETgXSZL+CXlpQ9t+W5kBD1nr17d+/ZA6cNiyQDYXRwA/buZ3nc7traGpvVahmyJCYkhqiZz+ZjBw40s+fkqc8OV1XhqGc2b45PiKcBd2FE3bux2Aj2s3ywZ6Q8WZlZT298Wq/Xd3d3VVUdRS6ErVQZ4RcUmvtNA6Z+AY8Hy+zt7j57+rO+nh5IKhTR1dV97Fg1wvDGp5/KyswgbmKBSKpgzPADzo8cXvo1XfLxRT+suae3+5NP9jfebFyxovDJpzZIpRKnw97W3nriRPW1q3XNzc0ymVSj0fB4PIVCCdPXGsLlCkVHRwc2Pf/88yvLSpFq88fzsXEHMPmU8xuLjWDmO+h0AaZMKOkz9e76cPfg4GB0TERWVubJk8dPfXZyeHhIrwmTSKRIs7zMx91VKpVQJLI6XHaHQyqVQpCXlpUKBQIEXjIguWCxaAmmX1Rm5t+w+7pMR48e7epuHxggL0ni8UicFvHIB76lUpnL5bKPjUEa5+Rk95iHek19Tz7x5Jq15UiO0TZslh8WPOksCwiLkODA9dDPopM7AV6f1WqrvVRLPgDY2NDX1yORiN0OckNCr9PBXtEGFsugRCodc3tTUlM3P7NJLpeRUUvGI8+/97V9ASzssehg3G1sNJFi+bkcuUJaWJiv0YRcvXrVarVLJHJkOk632+X1cN0uCGyb08ER8KMjIzc9tUEuFYPUhSusJmKxWfC9EJigc/Pmzd27d5tMJogmPp+P9R7mAzajo6ObN29eu3ZtSAiTLzFT7z4/fsFisaVJUwIU0nlS+E1JSdmwYQN4Rc+WSMhHVbAApmNjY8vKytTqe93zX6hYbC56SgSe4acjzEKhELIZZFutVqwfGRlBGF63fj19LJgiqIyFisfFRVME7hGdPXu2vb0dnrmhoSEyMjIjI6OwsBAGvZiopXi8CMbFAoEXaMCme3p6EHRhwXSHxRF3J+KxIxjxmHrsgLGCZkRi/C4y50zxeBH8GOKxUNGPM5YIXuRYIniRY4ngRY4lghc5lghe5FgieJFjieBFjiWCFzmWCF7kWCJ4kWOJ4EWOJYIXOZYIXuRYIniRY4ngRQ0W6/8DJqqWL+oHLu0AAAAASUVORK5CYII="}).on("click",function(){window.open("http://hedonometer.org","_blank")})},He="shiftsvg",Pe=function(t){var e=this
return arguments.length?(He=t,e):He},Be=function(t){var e=s[t],r=1==e||3==e?"+":"-",n=1==e||3==e?"more":"less",a=e>1?"↑":"↓",c=i[t]>0?"up":"down",u=i[t]>0?"rise":"fall",m=i[t]>0?"right":"left",g=my_shifter.get_word_index(l[t])
return'The word "'+l[t]+'" is shown as "'+o[t]+"\". Let's break that down: <br><ul><li>The "+r+" means "+l[t]+" is a "+n+" happy word than the reference average ($h_{\\textrm{avg}} {(\\textrm{"+l[t]+"})}="+p[g].toFixed(2)+"$ and $h^{\\textrm{(ref)}}_{\\textrm{avg}}="+f.toFixed(2)+"$).</li><li>The "+(e>1?"↑ means used more":"↓ means used less")+"  frequently in the comparison text than reference text ("+commaSeparateNumber(x[g])+" times to "+commaSeparateNumber(d[g])+" times, such that $p_\\textrm{"+l[t]+"}^{\\textrm{(comp)}} = "+(x[g]/d3.sum(x)).toFixed(3)+"$ and $p_\\textrm{"+l[t]+"}^{\\textrm{(ref)}}="+(d[g]/d3.sum(d)).toFixed(3)+"$).</li><li>Together this brings the comparison happiness <strong>"+(i[t]>0?"up":"down")+"</strong> by "+Math.abs(i[t]).toFixed(3)+", or "+Math.abs(i[t]/(f-h)).toFixed(2)+"%. We can see this as the individual term in the shift equations' sum:   $$\\underbrace{  \\left[  h_{\\textrm{avg}} {(\\textrm{"+l[t]+"})} – h^{\\textrm{(ref)}}_{\\textrm{avg}}  \\right]  }_{"+r+"}  \\underbrace{  \\left[  p_\\textrm{"+l[t]+"}^{\\textrm{(comp)}} – p_\\textrm{"+l[t]+"}^{\\textrm{(ref)}}  \\right]    }_{\\"+c+"arrow}.$$</li></ul>"+(1==e||3==e?"Positive, ":"Negative, ")+(e>1?" more frequent (":" less frequent (")+r+a+") words  will always be on the "+m+" contributing to a "+u+" in happiness."},Xe=function(){console.log("launching the tour")
var t=new Tour({steps:[{element:"#shiftsvg",title:"A quick wordshift whats-what",placement:"auto left",onShown:function(){console.log("first element shown"),MathJax.Hub.Queue(["Typeset",MathJax.Hub])},content:"Let’s say we have two texts which we call ‘reference’, ${T}^\\textrm{(ref)}$, and ‘comparison’, ${T}^\\textrm{(comp)}$. We want to know why the happiness of the comparison text, $h^{\\textrm{(comp)}}_{\\textrm{avg}}$, is higher or lower than that of the reference text $h^{\\textrm{(ref)}}_{\\textrm{avg}}$.<br>To do this, we analyze how each word $w$ which contributes to the difference in average happiness between the two texts:  $$h^{\\textrm{(comp)}}_{\\textrm{avg}} – h^{\\textrm{(ref)}}_{\\textrm{avg}} =   \\sum_{w \\in L}  \\underbrace{  \\left[  h_{\\textrm{avg}} {(w)} – h^{\\textrm{(ref)}}_{\\textrm{avg}}  \\right]  }_{+/-}  \\underbrace{  \\left[  p_w^{\\textrm{(comp)}} – p_w^{\\textrm{(ref)}}  \\right]    }_{\\uparrow/\\downarrow}.$$Next let's take a look at how the top three words contribute."},{element:"#shiftrect0",content:Be(0),placement:"auto left",onShown:function(){console.log("first element shown"),MathJax.Hub.Queue(["Typeset",MathJax.Hub])}},{element:"#shiftrect1",content:Be(1),placement:"auto left",onShown:function(){console.log("first element shown"),MathJax.Hub.Queue(["Typeset",MathJax.Hub])}},{element:"#shiftrect2",content:Be(2),placement:"auto left",onShown:function(){console.log("first element shown"),MathJax.Hub.Queue(["Typeset",MathJax.Hub])}},{element:"#sumTextR0",content:"At the top, we see the relative contributions from each of the four words types, and the total (the grey bar). This particular bar, $\\sum +\\uparrow$, shows the relative contribution to the shift in happiness from positive words that increased in frequency. <br><br>Try clicking this bar to see only those word types. To reset the view, click the grey $\\sum$ bar.<br><br>And that's all for now, we hope this quick what's-what was helpful!",placement:"auto left",onShown:function(){MathJax.Hub.Queue(["Typeset",MathJax.Hub])}}]})
t.init(),t.restart(),t.start(!0)},We=function(){st.append("a").attrs({class:"btn btn-large btn-default"}).styles({position:"absolute",left:function(){return dt-34+"px"}}).on("click",function(){Xe()}).append("i").attrs({class:"fa fa-question"})},qe=function(){function a(){if(!(this.__zoom<=0&&d3.event.deltaY<0)){d3.event.preventDefault(),this.__zoom+=d3.event.deltaY/2
var t=this
if(S.selectAll("rect.shiftrect").attr("y",function(e){return-t.__zoom}),S.selectAll("text.shifttext").attr("y",function(e){return-t.__zoom}),pe){var e=d3.event.translate.y/(At-Ft),r=e*g*bt/p.length
st.select(".distwin").attrs({y:d3.max([2,2-r])})}}}var l=this
if(Zt[0].length<1){if(h>=f)var d="happier"
else var d="less happy"
Zt=ht(["Reference happiness: "+f.toFixed(2),"Comparison happiness: "+h.toFixed(2),"Why comparison is "+d+" than reference:"],mt-10-Ee)}else jt&&(Zt=ht(Zt,mt-10-Ee))
st.selectAll("svg").remove(),C=st.append("svg").attr("id",He).attr("width",function(){return mt}).attr("height",function(){return gt})
bgbgrect=C.append("rect").attr("x",0).attr("y",0).attr("width",mt).attr("height",gt).attr("class","bgbg").attr("fill","rgba(255,248,220,.2)"),j=17*Zt.length+13,At=gt-vt.top-vt.bottom-j,M=d3.max(o.slice(0,7).map(function(t){return t.width(Re+"px  "+Fe)}))
if(k=d3.scaleLinear().domain([-Math.abs(i[0]),Math.abs(i[0])]).range([M+10,yt-M-10]),R=d3.scaleLinear().domain([bt+1,1]).range([At+2,Ft]),E=d3.zoom().translateExtent([[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]]).on("zoom",a),S=C.append("g").attr("transform","translate("+vt.left+","+(vt.top+j)+")").attr("width",yt).attr("height",At).attr("class","main"),S.on("wheel.zoom",a),L=S.append("rect").attrs({x:0,y:1,width:yt-2,height:At-2,class:"bg"}).styles({"stroke-width":"0.5",stroke:"rgb(0,0,0)",fill:"#FCFCFC",opacity:"0.96"}),ut){O=function(){return d3.axisBottom().ticks(4).scale(k)}().innerTickSize(3).outerTickSize(0),C.append("g").attr("class","x axis ").attr("font-size",Me).attr("transform","translate("+vt.left+","+(Ft+At)+")").call(O),C.selectAll(".tick line").styles({stroke:"black"})}Ie=["negdown","posdown","negup","posup"]
var x=["#b3b3ff","#ffffb3","#4c4cff","#ffff4c","#272727"]
if(H=S.selectAll("rect.shiftrect").data(i).enter().append("rect").attrs({class:function(t,e){return"shiftrect "+intStr0[s[e]]+" "+Ie[s[e]]},id:function(t,e){return"shiftrect"+e},x:0,y:0,transform:function(t,e){return t>0?"translate("+zt+","+R(e+1)+")":"translate("+k(t)+","+R(e+1)+")"},height:function(t,e){return wt},width:function(t,e){return t>0?k(t)-k(0):k(0)-k(t)},opacity:"0.7","stroke-width":"1",stroke:"rgb(0,0,0)",fill:function(t,e){return x[s[e]]}}),P=S.selectAll("text.shifttext").data(i).enter().append("text").attrs({class:function(t,e){return"shifttext "+intStr0[s[e]]},x:0,y:0,transform:function(t,e){return t>0?"translate("+(k(t)+2)+","+(R(e+1)+wt)+")":"translate("+(k(t)-2)+","+(R(e+1)+wt)+")"}}).styles({"text-anchor":function(t,e){return t<0?"end":"start"},"font-size":Re}).text(function(t,e){return o[e]}),ee){B=Array(o.length+1)
for(var m=0;m<B.length;m++)B[m]=0
B[B.length-1]=1,P.on("click",function(t,e){B[e]?(d3.select(this).text(o[e]),B[e]=0):(d3.select(this).text(c[e]),B[e]=1)})}if("posup"===$().current?(tt=!0,w=3,e(!0),S.selectAll("rect.shiftrect.zero").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.zero").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.one").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.one").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.two").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.two").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.three").attr("transform",function(t,e){return"translate("+(t>0?zt:k(t))+","+R(e+1)+")"}),S.selectAll("text.shifttext.three").attr("transform",function(t,e){return"translate("+(t>0?k(t)+2:k(t)-2)+","+(R(e+1)+wt)+")"})):"negdown"===$().current?(tt=!0,w=0,e(!0),S.selectAll("rect.shiftrect.zero").attr("transform",function(t,e){return"translate("+(t>0?zt:k(t))+","+R(e+1)+")"}),S.selectAll("text.shifttext.zero").attr("transform",function(t,e){return"translate("+(t>0?k(t)+2:k(t)-2)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.one").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.one").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.two").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.two").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.three").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.three").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"})):"posdown"===$().current?(tt=!0,w=1,e(!0),S.selectAll("rect.shiftrect.zero").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.zero").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.three").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.three").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.two").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.two").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.one").attr("transform",function(t,e){return"translate("+(t>0?zt:k(t))+","+R(e+1)+")"}),S.selectAll("text.shifttext.one").attr("transform",function(t,e){return"translate("+(t>0?k(t)+2:k(t)-2)+","+(R(e+1)+wt)+")"})):"negup"===$().current&&(tt=!0,w=2,e(!0),S.selectAll("rect.shiftrect.zero").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.zero").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.one").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.one").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.two").attr("transform",function(t,e){return"translate("+(t>0?zt:k(t))+","+R(e+1)+")"}),S.selectAll("text.shifttext.two").attr("transform",function(t,e){return"translate("+(t>0?k(t)+2:k(t)-2)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.three").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.three").attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"})),D=S.append("rect").attr("x",3).attr("y",3).attr("width",yt-vt.left-5).attr("height",60).attr("fill","white").styles({opacity:"1.0"}),topbgrect2=C.append("rect").attr("x",0).attr("y",0).attr("width",mt).attr("height",j).attr("fill","white").styles({opacity:"1.0"}),q=C.selectAll("text.titletext").data(Zt).enter().append("text").attr("y",function(t,e){return 17*(e+1)}).attr("x",3).attr("class",function(t,e){return"titletext "+intStr[e]}).styles({"font-size":function(t,e){return Yt[e]},"line-height":"1.42857143",color:function(t,e){return Ut[e]},"font-weight":function(t,e){return e<Ot?"bold":"normal"}}).text(function(t,e){return t}),bottombgrect=S.append("rect").attr("x",3).attr("y",xt-vt.bottom-j).attr("width",yt-2).attr("height",vt.bottom).attr("fill","white").styles({opacity:"1.0"}),N=S.append("line").attrs({x1:0,x2:yt-2,y1:60,y2:60}).styles({"stroke-width":"1",stroke:"black"}),X=Math.max(Math.abs(u[1]),Math.abs(u[2]),u[0],u[3],d3.sum(u)),Q=d3.scaleLinear().domain([-X,X]).range([34.1562,yt-34.1562]),W=[u[3],u[0],d3.sum(u)],Ie=["posup","negdown","sumgrey"],x=["#ffff4c","#b3b3ff","#272727"],S.selectAll(".sumrectR").data(W).enter().append("rect").attrs({class:function(t,e){return"sumrectR "+intStr0[e]+" "+Ie[e]},x:function(t,e){return t>0?zt:Q(t)},y:function(t,e){return e<3?17*e+7:17*e+7-2},height:function(t,e){return 14},width:function(t,e){return t>0?Q(t)-zt:zt-Q(t)},fill:function(t,e){return x[e]}}).styles({opacity:function(t,e){var r=[3,0,-1]
return tt&&w!==r[e]?"0.14":"0.7"},"stroke-width":"1",stroke:"rgb(0,0,0)"}).on("mouseover",function(t,e){var r=[3,0,-1]
if(tt)if(w===r[e]){d3.select(this).styles({opacity:"0.7"})}else{d3.select(this).styles({opacity:"0.3"})}else{d3.select(this).styles({opacity:"1.0"})}}).on("mouseout",function(t,e){var r=[3,0,-1]
if(tt)if(w===r[e]){d3.select(this).styles({opacity:"0.7"})}else{d3.select(this).styles({opacity:"0.14"})}else{d3.select(this).styles({opacity:"0.7"})}}).on("click",function(r,n){var a=[3,0,-1]
st.selectAll(".sumrectR,.sumrectL").styles({opacity:"0.1"})
d3.select(this).styles({opacity:"0.7"})
0==n?(tt=!0,w=a[n],e(!0),_.varval("posup"),S.selectAll("rect.shiftrect.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?zt:k(t))+","+R(e+1)+")"}),S.selectAll("text.shifttext.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?k(t)+2:k(t)-2)+","+(R(e+1)+wt)+")"})):1==n?(tt=!0,w=a[n],e(!0),_.varval("negdown"),S.selectAll("rect.shiftrect.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?zt:k(t))+","+R(e+1)+")"}),S.selectAll("text.shifttext.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?k(t)+2:k(t)-2)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"})):2==n&&t()}),S.selectAll(".sumtextR").data([u[3],u[0],d3.sum(u)]).enter().append("text").styles({"text-anchor":function(t,e){return t>0?"start":"end"},"font-size":Ce}).attrs({class:"sumtextR",id:function(t,e){return"sumTextR"+e},y:function(t,e){return 17*e+17},x:function(t,e){return Q(t)+5*t/Math.abs(t)}}).text(function(t,e){return 0==e?"∑+↑":1==e?"∑-↓":"∑"}),W=[u[1],u[2]],Ie=["posdown","negup"],x=["#ffffb3","#4c4cff"],S.selectAll(".sumrectL").data(W).enter().append("rect").attrs({class:function(t,e){return"sumrectL "+intStr0[e]+" "+Ie[e]},id:function(t,e){return"sumTextL"+e},x:function(t,e){return e<2?Q(t):(u[3]+u[1])*(u[0]+u[2])>0?t>0?Q(u[3]+u[1]):Q(t)-(zt-Q(u[3]+u[1])):t>0?zt:Q(t)},y:function(t,e){return 17*e+7},height:function(t,e){return 14},width:function(t,e){return t>0?Q(t)-zt:zt-Q(t)},fill:function(t,e){return x[e]}}).styles({opacity:function(t,e){var r=[1,2]
return tt&&w!==r[e]?"0.14":"0.7"},"stroke-width":"1",stroke:"rgb(0,0,0)"}).on("mouseover",function(t,e){var r=[1,2]
if(tt)if(w===r[e]){d3.select(this).styles({opacity:"0.7"})}else{d3.select(this).styles({opacity:"0.3"})}else{d3.select(this).styles({opacity:"1.0"})}}).on("mouseout",function(t,e){var r=[1,2]
if(tt)if(w===r[e]){d3.select(this).styles({opacity:"0.7"})}else{d3.select(this).styles({opacity:"0.14"})}else{d3.select(this).styles({opacity:"0.7"})}}).on("click",function(t,r){var n=[1,2]
tt=!0,w=n[r],st.selectAll(".sumrectR,.sumrectL").styles({opacity:"0.1"})
d3.select(this).styles({opacity:"0.7"})
e(!0),0==r?(_.varval("posdown"),S.selectAll("rect.shiftrect.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?zt:k(t))+","+R(e+1)+")"}),S.selectAll("text.shifttext.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?k(t)+2:k(t)-2)+","+(R(e+1)+wt)+")"})):1==r&&(_.varval("negup"),S.selectAll("rect.shiftrect.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?zt:k(t))+","+R(e+1)+")"}),S.selectAll("text.shifttext.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?k(t)+2:k(t)-2)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}))}),S.selectAll(".sumtextL").data(W).enter().append("text").styles({"text-anchor":"end","font-size":Ce}).attr("class","sumtextL").attr("y",function(t,e){return 17*e+17}).text(function(t,e){return 0==e?"∑+↓":"∑-↑"}).attr("x",function(t,e){return Q(t)-5}),T=C.append("text").text(Dt).attr("class","axes-text").attr("x",vt.left+zt).attr("y",gt-7).styles({"font-size":ke,fill:"#000000","text-anchor":"middle"}),I=C.append("text").text(Nt).attr("class","axes-text").attr("x",18).attr("y",At/2+60+j).attr("font-size",ke).attr("fill","#000000").attr("transform","rotate(-90.0,18,"+(At/2+60+j)+")"),S.property("__zoom",0),pe){be()
var g=250
V=S.append("g").attrs({class:"dist",fill:"#B8B8B8",transform:"translate(5,"+(At-28-g)+")"}),V.append("rect").attrs({x:0,y:0,height:g,width:70,class:"distbg","stroke-width":"2",stroke:"rgb(150,150,150)",fill:"#FCFCFC",opacity:"0.96"})
var v=d3.scaleLinear().domain(d3.extent(b.map(function(t){return t[4]}))).range([1,68]),y=d3.scaleLinear().domain([0,99]).range([2,g-2]),A=d3.line().x(function(t,e){return v(t)}).y(function(t,e){return y(e)}).curve(d3.curveCardinal),U=(V.append("path").datum(b.map(function(t){return t[4]})).attr("class","line").attr("d",A).attr("stroke","red").attr("stroke-width",1.25).attr("fill","none"),d3.scaleLinear().domain(d3.extent(F.map(function(t){return t[4]}))).range([1,68])),Y=d3.line().x(function(t,e){return U(t)}).y(function(t,e){return y(e)}).curve(d3.curveCardinal)
V.append("path").datum(F.map(function(t){return t[4]})).attr("class","line").attr("d",Y).attr("stroke","blue").attr("stroke-width",1.25).attr("fill","none"),V.append("rect").attrs({x:0,y:2,height:g*bt/z,width:70,class:"distwin","stroke-width":"0.75",stroke:"rgb(20,20,20)",fill:"#FCFCFC",opacity:"0.6"}),V.append("text").attrs({x:72,y:g+2,class:"nwordslabel"}).styles({fill:"#B8B8B8","font-size":Qe,"text-anchor":"start"}).text(z)
V.append("text").attrs({x:72,y:2,class:"zerolabel"}).styles({fill:"#B8B8B8","font-size":Qe,"text-anchor":"start"}).text("0")}return G=S.selectAll("text.credit").data(["visualization by","@andyreagan"]).enter().append("text").attrs({class:"credit",x:yt-5,y:function(t,e){return At-15+10*e}}).styles({"text-anchor":"end",fill:"#B8B8B8","font-size":Le}).text(function(t){return t}),ot||d3.select(window).on("resize.shiftplot",n),Pt&&e(!0),ee&&(console.log(ee),r()),l},je=function(){var t=this
"table"===rt().cached&&(U.remove(),Y.remove(),J.remove(),K.remove(),Z.remove()),et.varval("cloud"),S.selectAll("rect.shiftrect").transition().duration(1e3).attr("x",1e3),S.selectAll(".sumrectR").transition().duration(2e3).attr("x",1e3),S.selectAll(".sumtextR").transition().duration(2e3).attr("x",1e3),S.selectAll(".sumrectL").transition().duration(2e3).attr("x",-1e3),S.selectAll(".sumtextL").transition().duration(2e3).attr("x",-1e3),bottombgrect.attr("y",1e3),T.transition().duration(2e3).attr("y",1e3),I.transition().duration(2e3).attr("x",-1e3),D.transition().duration(2e3).attr("y",-200),N.transition().duration(1e3).attrs({y1:-10,y2:-10})
var e=d3.scaleLinear().domain([Math.abs(i[49]),Math.abs(i[0])]).range([6,70])
st.selectAll("canvas").remove(),st.append("canvas").attrs({width:yt,height:At,id:"cloudcanvas"}).styles({display:"none"})
var r=document.getElementById("cloudcanvas").getContext("2d")
st.append("canvas").attrs({width:yt,height:At,id:"cloudcanvas2"}).styles({display:"none"})
var n=document.getElementById("cloudcanvas2").getContext("2d")
r.textAlign="center",r.fillStyle="red",r.strokeStyle="red",r.textAlign="center",r.save()
for(var s=l.map(function(t,r){return a={},a.text=t,a.rotate=90*Math.round(1*Math.random()-.5),a.size=e(Math.abs(i[r])),a.fontString=a.size+"px  "+Fe,a.padding=1,a.x=zt+(Math.random()-.5)*yt/2,a.y=At/2,a}),o=[yt,At],c=[],u=-1;u++<199;){var f=s[u]
cloudSpriteSimple(n,f,o)
var h=monochrome(r.getImageData(0,0,o[0],o[1]).data);(function(t,e,r){var n=(o[0],o[1],e.x),a=e.y,i=Math.sqrt(o[0]*o[0]+o[1]*o[1]),s=o[0]/o[1],l=Math.random()<.5?1:-1
l*=2
for(var c,u,f,h=-l;(c=function(t){return[s*t*Math.cos(t),t*Math.sin(t)]}(h+=l))&&(u=c[0],f=c[1],!(Math.min(Math.abs(u),Math.abs(f))>=i));)if(e.x=n+u,e.y=a+f,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>o[0]||e.y+e.y1>o[1])){var d={x0:Math.floor(e.x)+e.x0,y0:Math.floor(e.y)-e.y1,w:2*e.x1,h:e.y1}
d.x1=d.x0+d.w,d.y1=d.y0+d.h
for(var x=indexer2d(r,o[0],d.y0,d.y1,d.x0,d.x1),p=0;p<e.sprite.length&&(!e.sprite[p]||!x[p]);p++);if(p===e.sprite.length)return t.push(d),!0}!1})(c,f,h)
r.setTransform(1,0,0,1,0,0),r.save(),r.font=f.fontString,r.lineWidth=2*f.padding,r.translate(f.x,f.y),r.rotate(f.rotate*cloudRadians),r.fillText(f.text,0,0),r.strokeText(f.text,0,0),r.restore()}return S.selectAll("text.shifttext").data(s).filter(function(t,e){if(e<200)return 1}).text(function(t,e){return t.text}).transition().duration(1e3).delay(function(t,e){return 10*e}).attr("placed",function(t,e){return t.placed}).attr("x",function(t,e){return 0}).attr("y",function(t,e){return 0}).style("text-anchor","middle").style("font",function(t,e){return t.fontString}).attr("transform",function(t,e){return"translate("+[t.x,t.y]+")rotate("+t.rotate+")"}),t},Ge=function(){var t=this
et.varval("table")
var r=20,n=r+70+25+25+35,a=yt-n,u=["start","start","middle","middle","end","middle"]
xpadding=10
var d=n+a/2,x=[0,r,r+70,r+70+25,r+70+25+25+35,d]
k.domain([-Math.abs(i[0]),Math.abs(i[0])]).range([xpadding,a-xpadding]),Ft=15,R.range([At+2,Ft]),e(!1)
var p=S.selectAll("rect.shiftrect").data(i),m=S.selectAll("text.shifttext").data(i)
return p.transition().duration(1e3).attrs({fill:"grey",class:function(t,e){return"shiftrect "+intStr0[s[e]]},transform:function(t,e){return t>0?"translate("+d+","+(R(e+1)+2.5)+")":"translate("+(k(t)+n)+","+(R(e+1)+2.5)+")"},height:function(t,e){return wt},width:function(t,e){return t>0?k(t)-k(0):k(0)-k(t)}}),m.transition().duration(1e3).attrs({class:function(t,e){return"shifttext "+intStr0[s[e]]},transform:function(t,e){return"translate("+r+","+(R(e+1)+wt)+")"}}).styles({"text-anchor":"start","font-size":Re}).text(function(t,e){return l[e]}),o=l,ee&&(c=void 0),U=S.selectAll("text.shiftrank").data(i).enter().append("text").attr("y",function(t,e){return R(e+1)+wt}).attr("x",function(t,e){return 0}).styles({"text-anchor":"start","font-size":Re}).text(function(t,e){return e+1+"."}),J=S.selectAll("text.shifttype").data(i).enter().append("text").attr("y",function(t,e){return R(e+1)+wt}).attr("x",function(t,e){return r+70}).styles({"text-anchor":"middle","font-size":Re}).text(function(t,e){return 0==s[e]?"-":2==s[e]?"-":"+"}),Y=S.selectAll("text.shiftfreq").data(i).enter().append("text").attr("y",function(t,e){return R(e+1)+wt}).attr("x",function(t,e){return r+70+25}).styles({"text-anchor":"middle","font-size":Re}).text(function(t,e){return 0==s[e]?"↓":1==s[e]?"↓":"↑"}),K=S.selectAll("text.shiftmag").data(i).enter().append("text").attr("y",function(t,e){return R(e+1)+wt}).attr("x",function(t,e){return r+70+25+25+35}).styles({"text-anchor":"end","font-size":Re}).text(function(t,e){return(t/Math.abs(h-f)*100).toFixed(2)+"%"}),Z=S.selectAll("text.header").data(["#","Word","+/-","↑/↓","% Cont.","% Cont."]).enter().append("text").attrs({x:function(t,e){return x[e]},y:function(t,e){return R(0)+wt}}).styles({"text-anchor":function(t,e){return u[e]},"font-size":function(t,e){return Re}}).text(function(t,e){return t}),S.selectAll(".sumrectR").transition().duration(2e3).attr("x",1e3),S.selectAll(".sumtextR").transition().duration(2e3).attr("x",1e3),S.selectAll(".sumrectL").transition().duration(2e3).attr("x",-1e3),S.selectAll(".sumtextL").transition().duration(2e3).attr("x",-1e3),L.style("stroke-width",0),bottombgrect.attr("y",1e3),T.transition().duration(2e3).attr("y",1e3),I.transition().duration(2e3).attr("x",-1e3),D.transition().duration(2e3).attr("y",-200),N.transition().duration(1e3).attrs({y1:"15",y2:15}),t}
return{shift:xe,ignore:ue,setTextBold:Vt,stop:fe,istopper:he,shifter:Ae,selfShifter:ge,setfigure:ct,getfigure:lt,setdata:qt,plot:qe,add_help_button:We,show_x_axis:ft,replot:function(){var t=this
if(R.range([At+2,64]),N.transition().duration(1e3).attrs({y1:60,y2:60}),"table"===rt().cached&&(U.remove(),Y.remove(),J.remove(),K.remove(),Z.remove()),et.varval("wordshift"),Zt[0].length<1){if(h>=f)var r="happier"
else var r="less happy"
Zt=ht(["Reference happiness: "+f.toFixed(2),"Comparison happiness: "+h.toFixed(2),"Why comparison is "+r+" than reference:"],mt-10-Ee,"14px  "+Fe)}else jt&&(Zt=ht(Zt,mt-10-Ee,"14px  "+Fe))
M=d3.max(o.slice(0,5).map(function(t){return t.width(Re+"px  "+Fe)}))
k.domain([-Math.abs(i[0]),Math.abs(i[0])]).range([M+10,yt-M-10]),ut&&C.select(".x.axis").call(O),j=17*Zt.length+13,e(!0),At=gt-vt.top-vt.bottom-j,R.range([At+2,64]),S.attr("transform","translate("+vt.left+","+(vt.top+j)+")").attr("height",At),L.attr("height",At-2).styles({"stroke-width":.5,stroke:"rgb(20,20,20)"}),topbgrect2.attr("height",j),C.selectAll("text.credit").remove(),G.remove(),G=S.selectAll("text.credit").data(["visualization by","@andyreagan"]).enter().append("text").attrs({class:"credit",fill:"#B8B8B8",x:yt-5,y:function(t,e){return At-15+10*e},"font-size":"8.0px"}).styles({"text-anchor":"end"}).text(function(t){return t}),C.selectAll("text.titletext").remove(),q.remove(),q=C.selectAll("text.titletext").data(Zt).enter().append("text").attrs({y:function(t,e){return 17*(e+1)},x:3,class:function(t,e){return"titletext "+intStr[e]}}).styles({"font-size":function(t,e){return Yt[e]},"line-height":"1.42857143",color:function(t,e){return Ut[e]},"font-weight":function(t,e){return e<Ot?"bold":"normal"}}).text(function(t,e){return t}),bottombgrect.attr("y",xt-vt.bottom-j)
var n=S.selectAll("rect.shiftrect").data(i),a=S.selectAll("text.shifttext").data(i)
return"none"===$().current||0===$().current.length?(n.transition().duration(1500).attrs({fill:function(t,e){return 2==s[e]?"#4C4CFF":3==s[e]?"#FFFF4C":0==s[e]?"#B3B3FF":"#FFFFB3"},class:function(t,e){return"shiftrect "+intStr0[s[e]]},x:0,y:0,transform:function(t,e){return t>0?"translate("+zt+","+R(e+1)+")":"translate("+k(t)+","+R(e+1)+")"},height:function(t,e){return wt},width:function(t,e){return t>0?k(t)-k(0):k(0)-k(t)}}),a.transition().duration(1500).attrs({class:function(t,e){return"shifttext "+intStr0[s[e]]},x:0,y:0,transform:function(t,e){return t>0?"translate("+(k(t)+2)+","+(R(e+1)+wt)+")":"translate("+(k(t)-2)+","+(R(e+1)+wt)+")"}}).styles({"text-anchor":function(t,e){return i[e]<0?"end":"start"},"font-size":Re}).text(function(t,e){return o[e]})):(n.attrs({fill:function(t,e){return 2==s[e]?"#4C4CFF":3==s[e]?"#FFFF4C":0==s[e]?"#B3B3FF":"#FFFFB3"},class:function(t,e){return"shiftrect "+intStr0[s[e]]},x:0,y:0,transform:function(t,e){return t>0?"translate("+zt+","+R(e+1)+")":"translate("+k(t)+","+R(e+1)+")"},height:function(t,e){return wt},width:function(t,e){return t>0?k(t)-k(0):k(0)-k(t)}}),a.attrs({class:function(t,e){return"shifttext "+intStr0[s[e]]},x:0,y:0,transform:function(t,e){return t>0?"translate("+(k(t)+2)+","+(R(e+1)+wt)+")":"translate("+(k(t)-2)+","+(R(e+1)+wt)+")"}}).styles({"text-anchor":function(t,e){return i[e]<0?"end":"start"},"font-size":Re}).text(function(t,e){return o[e]}),"posup"===$().current?(S.selectAll("rect.shiftrect.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?zt:k(t))+","+R(e+1)+")"}),S.selectAll("text.shifttext.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?k(t)+2:k(t)-2)+","+(R(e+1)+wt)+")"})):"negdown"===$().current?(S.selectAll("rect.shiftrect.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?zt:k(t))+","+R(e+1)+")"}),S.selectAll("text.shifttext.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?k(t)+2:k(t)-2)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"})):"posdown"===$().current?(S.selectAll("rect.shiftrect.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?zt:k(t))+","+R(e+1)+")"}),S.selectAll("text.shifttext.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?k(t)+2:k(t)-2)+","+(R(e+1)+wt)+")"})):"negup"===$().current&&(S.selectAll("rect.shiftrect.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.zero").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.one").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?zt:k(t))+","+R(e+1)+")"}),S.selectAll("text.shifttext.two").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?k(t)+2:k(t)-2)+","+(R(e+1)+wt)+")"}),S.selectAll("rect.shiftrect.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+R(e+1)+")"}),S.selectAll("text.shifttext.three").transition().duration(1e3).attr("transform",function(t,e){return"translate("+(t>0?500:-500)+","+(R(e+1)+wt)+")"}))),X=Math.max(Math.abs(u[1]),Math.abs(u[2]),u[0],u[3]),Q.domain([-X,X]),W=[u[3],u[0],d3.sum(u)],S.selectAll(".sumrectR").data(W).transition().duration(1500).attr("x",function(t,e){return t>0?zt:Q(t)}).attr("width",function(t,e){return t>0?Q(t)-zt:zt-Q(t)}),S.selectAll(".sumtextR").data([u[3],u[0],d3.sum(u)]).transition().duration(1500).attr("class","sumtextR").style("text-anchor",function(t,e){return t>0?"start":"end"}).attr("x",function(t,e){return Q(t)+5*t/Math.abs(t)}),W=[u[1],u[2],u[0]+u[2]],S.selectAll(".sumrectL").data(W).transition().duration(1500).attr("fill",function(t,e){return 0==e?"#FFFFB3":1==e?"#4C4CFF":t>0?"#B3B3FF":"#4C4CFF"}).attr("x",function(t,e){return e<2?Q(t):(u[3]+u[1])*(u[0]+u[2])>0?t>0?Q(u[3]+u[1]):Q(t)-(zt-Q(u[3]+u[1])):t>0?zt:Q(t)}).attr("width",function(t,e){return t>0?Q(t)-zt:zt-Q(t)}),S.selectAll(".sumtextL").data([u[1],u[2]]).transition().duration(1500).attr("x",function(t,e){return Q(t)-5}),t},table:Ge,cloud:je,setText:_t,setWidth:Mt,setHeight:kt,splitstring:ht,drawlogo:Se,resetbuttontoggle:Wt,plotdist:me,_reset:Bt,_stoprange:re,_refF:ne,_compF:ae,_lens:ie,_complens:se,_words:oe,_words_en:le,_refH:St,_compH:Ht,_xlabel_text:It,_ylabel_text:Et,setTextColors:Jt,setTopTextSizes:Kt,_split_top_strings:Gt,_shiftMag:ve,_shiftType:ye,dualShifter:we,setFontSizes:De,_fontString:ze,_viz_type_use_URL:at,_my_shift_id:Pe,_sortedMag:Rt,_sortedType:Qt,_sortedWords:Lt,_sortedWordsRaw:Tt,get_word_index:Xt}}
var cloudRadians=Math.PI/180
